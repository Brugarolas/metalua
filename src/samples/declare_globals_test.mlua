-{ extension 'declare_globals' }

global a, b
global c = 3

a, b = 1, 2

local st1, msg1 = pcall(function()
   a = 10
   d = 20 -- failure, assignment to undeclared global
end)

local st2, msg2 = pcall(function()
   b = c -- OK
   local _ = d -- failure, try to read undeclared global
end)

assert(not st1)
assert(not st2)
assert(a==10)
assert(b==3)
assert(c==3)

print "Test passed."