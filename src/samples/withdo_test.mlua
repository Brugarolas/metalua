-{ extension 'withdo' }

local original_close = io.close
function io:close()
   original_close(self)
   print "closed a file"
end

function x()
   --with f = io.open 'withdo_test.mlua' do
   with f = io.open 'withdo_test.mlua' do
      for l in f:lines() do
         printf("[%s]", l)
      end
      return '123'
   end
end

print(x())